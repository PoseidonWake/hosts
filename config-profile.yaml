port: 7890
socks-port: 7891
allow-lan: false
mode: Rule
log-level: info
external-controller: 127.0.0.1:9090
ipv6: false
# global-ua: clash.meta
keep-alive-interval: 15
keep-alive-idle: 1200
disable-keep-alive: false
geodata-mode: true
geox-url:
  geoip: "https://cdn.jsdelivr.net/gh/Loyalsoldier/v2ray-rules-dat@release/geoip.dat"
  geosite: "https://cdn.jsdelivr.net/gh/Loyalsoldier/v2ray-rules-dat@release/geosite.dat"
#  mmdb: "https://fastly.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@release/geoip.metadb
geo-auto-update: true # æ˜¯å¦è‡ªåŠ¨æ›´æ–° geodata
geo-update-interval: 24 # æ›´æ–°é—´éš”ï¼Œå•ä½ï¼šå°æ—¶
hosts:
  local.adguard.org: 127.0.0.1
  mtalk.google.com: 142.251.8.188
  ulogs.umengcloud.com: 0.0.0.0
  beacons3.gvt2.com: 0.0.0.0
# '.dev': 127.0.0.1
dns:
  cache-algorithm: arc
  enable: true
  ipv6: false
  prefer-h3: true
  listen: 127.0.0.1:8853
  enhanced-mode: fake-ip
  fake-ip-range: 198.18.0.1/16
  fake-ip-filter-mode: blacklist
#  use-system-hosts: true
#  use-hosts: true
    # é…ç½®åé¢çš„nameserverã€fallbackå’Œnameserver-policyå‘dnsæœåŠ¡å™¨çš„è¿æ¥è¿‡ç¨‹æ˜¯å¦éµå®ˆéµå®ˆrulesè§„åˆ™
  # å¦‚æœä¸ºfalseï¼ˆé»˜è®¤å€¼ï¼‰åˆ™è¿™ä¸‰éƒ¨åˆ†çš„dnsæœåŠ¡å™¨åœ¨æœªç‰¹åˆ«æŒ‡å®šçš„æƒ…å†µä¸‹ä¼šç›´è¿
  # å¦‚æœä¸ºtrueï¼Œå°†ä¼šæŒ‰ç…§rulesçš„è§„åˆ™åŒ¹é…é“¾æ¥æ–¹å¼ï¼ˆèµ°ä»£ç†æˆ–ç›´è¿ï¼‰ï¼Œå¦‚æœæœ‰ç‰¹åˆ«æŒ‡å®šåˆ™ä»»ç„¶ä»¥æŒ‡å®šå€¼ä¸ºå‡†
  # ä»…å½“proxy-server-nameserveréç©ºæ—¶å¯ä»¥å¼€å¯æ­¤é€‰é¡¹, å¼ºçƒˆä¸å»ºè®®å’Œprefer-h3ä¸€èµ·ä½¿ç”¨
  # æ­¤å¤–ï¼Œè¿™ä¸‰è€…é…ç½®ä¸­çš„dnsæœåŠ¡å™¨å¦‚æœå‡ºç°åŸŸåä¼šé‡‡ç”¨default-nameserveré…ç½®é¡¹è§£æï¼Œä¹Ÿè¯·ç¡®ä¿æ­£ç¡®é…ç½®default-nameserver
  respect-rules: false
  default-nameserver:
#    - 119.29.29.29
    - system
    - system://
    - dhcp://system
    - 114.114.114.114
  fake-ip-filter:
    - speedtest.cros.wr.pvp.net'
    - "rule-set:FakeFilter"
  proxy-server-nameserver:
      - system
      - system://
      - dhcp://system
      - 'https://doh-åˆ é™¤-clash.doh.pub/dns-query#skip-cert-verify=true'
  nameserver-policy:
    #   'www.baidu.com': '114.114.114.114'
    #   '+.internal.crop.com': '10.0.0.1'
  #  "geosite:geolocation-!cn":
  #    - 'tcp://1.1.1.1#Final'
  #    - 'tls://8.8.8.8:853#Final'      
#      - https://dns.alidns.com/dns-quer
#    "geosite:category-ads-all": rcode://success
#    "www.baidu.com,+.google.cn": [223.5.5.5, https://dns.alidns.com/dns-query]
    ## globalï¼Œdns ä¸º rule-providers ä¸­çš„åä¸º global å’Œ dns è§„åˆ™è®¢é˜…ï¼Œ
    ## ä¸” behavior å¿…é¡»ä¸º domain/classicalï¼Œå½“ä¸º classical æ—¶ä»…ä¼šç”Ÿæ•ˆåŸŸåç±»è§„åˆ™
    "rule-set:Local,Unbreak,CNFIX,AppleCDN,AppleCN,MicrosoftCDN,ChinaDomain,China":
      - system
      - system://
      - dhcp://system
      - 'https://doh-åˆ é™¤-clash.doh.pub/dns-query#skip-cert-verify=true'
    "rule-set:adblock": rcode://success
    "geosite:category-ads-all": rcode://success
    "geosite:cn,private":
      - system
      - system://
      - dhcp://system
      - 'https://doh-åˆ é™¤-clash.doh.pub/dns-query#skip-cert-verify=true'
  #    - 119.29.29.29  
  nameserver:
  #  - system
  #  - tls://223.5.5.5:853
  #  - 'https://doh-åˆ é™¤-clash.doh.pub/dns-query#skip-cert-verify=true'
  #  - 119.29.29.29
#    - 223.5.5.5
#    - tls://120.53.53.53
#    - tls://1.12.12.12
    - tls://8.8.8.8:853#Final
    - tls://1.1.1.1:853#Final
#  fallback:
#    - 'tcp://1.1.1.1#Final'
#    - 'tcp://208.67.222.222#Final'
#    - 'tls://8.8.8.8:853#Final'
#    - https://185.222.222.222/dns-query
#    - quic://dns.adguard.com:784
#  fallback-filter:
#    geoip: true
#    geoip-code: CN
#    geosite:
#      - gfw
#    ipcidr:
#      - 240.0.0.0/4
#      - 0.0.0.0/32
#      - 127.0.0.1/32
#    domain:
#      - '+.google.com'
#      - '+.facebook.com'
#      - '+.twitter.com'
#      - '+.youtube.com'
#      - '+.xn--ngstr-lra8j.com'
#      - '+.googleapis.cn'
#      - '+.googleapis.com'
#      - '+.gvt1.com'
proxy-providers:
  provide1:
    type: http
    path: .
    url: 
    interval: 7200
    health-check:
        enable: true
        lazy: true
        url: http://www.gstatic.com/generate_204
        interval: 7200
    override:
      additional-prefix: ""
  provide2:
    type: http
    path: ./provide2.yaml
    url: 
    interval: 7200
    health-check:
        enable: true
        lazy: true
        url: http://www.gstatic.com/generate_204
        interval: 7200
    override:
      additional-prefix: ""
#    proxy-name:
#      - pattern: "trojan"
#        target: ""
proxy-groups:
  - name: "ğŸš€ Global"
    type: select
    proxies:
      - "ğŸ‡­ğŸ‡° HK"
      - "ğŸ‡¹ğŸ‡¼ TW"
      - "ğŸ‡ºğŸ‡² US"
      - "ğŸ‡¯ğŸ‡µ JP"
      - "ğŸ‡¸ğŸ‡¬ SG"
      - "ğŸ³ï¸â€ğŸŒˆ NR"
      - DIRECT
    use:
      - provide1
      - provide2
  - name: "ğŸ‡­ğŸ‡° HK"
    type: select
    use:
      - provide1
      - provide2
    filter: "æ¸¯|HK|Hong"
  - name: "ğŸ‡¹ğŸ‡¼ TW"
    type: select
    use:
      - provide1
      - provide2
    filter: "å°|æ–°åŒ—|å½°åŒ–|TW|Taiwan"
  - name: "ğŸ‡ºğŸ‡² US"
    type: select
    use:
      - provide1
      - provide2
    filter: "ç¾|æ´›æ‰çŸ¶|ç¡…è°·|è¾¾æ‹‰æ–¯|è´¹åˆ©è’™|å‡¤å‡°åŸ|èŠåŠ å“¥|åœ£ä½•å¡|è¥¿é›…å›¾|US|America|USA"
  - name: "ğŸ‡¯ğŸ‡µ JP"
    type: select
    use:
      - provide1
      - provide2
    filter: "æ—¥((?!ç”¨).)+|ä¸œäº¬|å¤§é˜ª|åŸ¼ç‰|JP|Japan"
  - name: "ğŸ‡¸ğŸ‡¬ SG"
    type: select
    use:
      - provide1
      - provide2
    filter: "((?!æœ€).)+æ–°|æ–°åŠ å¡|ç‹®åŸ|SG|Singapore"
  - name: "ğŸ³ï¸â€ğŸŒˆ NR"
    type: select
    use:
      - provide1
      - provide2
    exclude-filter: "æ¸¯|HK|Hong|å°|æ–°åŒ—|å½°åŒ–|TW|Taiwan|ç¾|æ´›æ‰çŸ¶|ç¡…è°·|è¾¾æ‹‰æ–¯|è´¹åˆ©è’™|å‡¤å‡°åŸ|èŠåŠ å“¥|åœ£ä½•å¡|è¥¿é›…å›¾|US|America|USA|æ—¥((?!ç”¨).)+|ä¸œäº¬|å¤§é˜ª|åŸ¼ç‰|JP|Japan|((?!æœ€).)+æ–°|æ–°åŠ å¡|ç‹®åŸ|SG|Singapore"
  - name: "ğŸ“² Telegram"
    type: select
    proxies:
      - ğŸš€ Global
      - "ğŸ‡¸ğŸ‡¬ SG"
  - name: "ğŸ‘â€ğŸ—¨ Maybe"
    type: select
    proxies:
      - DIRECT
      - "ğŸš€ Global"
      - "ğŸ‡­ğŸ‡° HK"
      - "ğŸ‡¹ğŸ‡¼ TW"
    use:
      - provide1
      - provide2
  - name: "ğŸ Apple&MS"
    type: select
    proxies:
      - DIRECT
      - "ğŸš€ Global"
      - "ğŸ‡­ğŸ‡° HK"
      - "ğŸ‡¹ğŸ‡¼ TW"
      - "ğŸ‡ºğŸ‡² US"
      - "ğŸ‡¯ğŸ‡µ JP"
      - "ğŸ‡¸ğŸ‡¬ SG"
      - "ğŸ³ï¸â€ğŸŒˆ NR"
    use:
      - provide1
      - provide2
  - name: "ğŸ¥ Streaming"
    type: select
    proxies:
      - "ğŸš€ Global"
      - DIRECT
      - "ğŸ‡­ğŸ‡° HK"
      - "ğŸ‡¹ğŸ‡¼ TW"
      - "ğŸ‡ºğŸ‡² US"
      - "ğŸ‡¯ğŸ‡µ JP"
      - "ğŸ‡¸ğŸ‡¬ SG"
      - "ğŸ³ï¸â€ğŸŒˆ NR"
    use:
      - provide1
      - provide2
  - name: "ğŸ‡¨ğŸ‡³ CN"
    type: select
    proxies:
      - DIRECT
      - "ğŸš€ Global"
  - name: "ğŸš« AD"
    type: select
    proxies:
      - REJECT
      - DIRECT
  - name: "Final"
    type: select
    proxies:
      - "ğŸš€ Global"
      - DIRECT
rule-providers:
  FakeFilter:
    type: http
    behavior: domain
    path: ./RuleSet/FakeipFilter.yaml
    url: https://raw.githubusercontent.com/PoseidonWake/hosts/master/fake-ip-filter.yaml
    interval: 86400
  Local:
    type: http
    behavior: classical
    path: ./RuleSet/Local.yaml
    url: https://raw.githubusercontent.com/PoseidonWake/hosts/master/Local.yaml
    interval: 86400
  Unbreak:
    type: http
    behavior: classical
    path: ./RuleSet/Unbreak.yaml
    url: https://raw.githubusercontent.com/PoseidonWake/hosts/master/Unbreak.yaml
    interval: 86400
  StreamingSE:
    type: http
    behavior: classical
    path: ./RuleSet/StreamingMedia/StreamingSE.yaml
    url: https://raw.githubusercontent.com/PoseidonWake/hosts/master/StreamingSE.yaml
    interval: 86400
  AppleCDN:
    type: http
    behavior: domain
    path: ./RuleSet/AppleCDN.yaml
    url: https://raw.githubusercontent.com/RealSeek/Clash_Rule_DIY/mihomo/DIRECT/no_ip/AppleCDN_no_ip.yaml
    interval: 86400
  AppleCN:
    type: http
    behavior: classical
    path: ./RuleSet/AppleCN.yaml
    url: https://raw.githubusercontent.com/RealSeek/Clash_Rule_DIY/mihomo/DIRECT/no_ip/AppleCN_no_ip.yaml
    interval: 86400
  MicrosoftCDN:
    type: http
    behavior: classical
    path: ./RuleSet/MicrosoftCDN.yaml
    url: https://raw.githubusercontent.com/RealSeek/Clash_Rule_DIY/mihomo/DIRECT/no_ip/MicrosoftCDN_no_ip.yaml
    interval: 86400
  Apple:
    type: http
    behavior: classical
    path: ./RuleSet/Apple.yaml
    url: https://raw.githubusercontent.com/RealSeek/Clash_Rule_DIY/mihomo/PROXY/no_ip/Apple_no_ip.yaml
    interval: 86400
  Microsoft:
    type: http
    behavior: classical
    path: ./RuleSet/Microsoft.yaml
    url: https://raw.githubusercontent.com/RealSeek/Clash_Rule_DIY/mihomo/PROXY/no_ip/Microsoft_no_ip.yaml
    interval: 86400
  CDN:
    type: http
    behavior: classical
    path: ./RuleSet/CDN.yaml
    url: https://raw.githubusercontent.com/RealSeek/Clash_Rule_DIY/mihomo/PROXY/no_ip/CDN_no_ip.yaml
    interval: 86400
  Streaming:
    type: http
    behavior: classical
    path: ./RuleSet/StreamingMedia/ProxyMedia.yaml
    url: https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/master/Clash/Providers/ProxyMedia.yaml
    interval: 86400
  China:
    type: http
    behavior: classical
    path: ./RuleSet/China.yaml
    url: https://raw.githubusercontent.com/PoseidonWake/hosts/master/China.yaml
    interval: 86400
  GoogleDrive:
    type: http
    behavior: classical
    path: ./RuleSet/GoogleDrive.yaml
    url: https://raw.githubusercontent.com/PoseidonWake/hosts/master/GoogleDrive.yaml
    interval: 86400
  Download:
    type: http
    behavior: domain
    path: ./RuleSet/Download_domainset.yaml
    url: https://raw.githubusercontent.com/RealSeek/Clash_Rule_DIY/mihomo/PROXY/no_ip/Download_domainset.yaml
    interval: 86400
  Telegram:
    type: http
    behavior: classical
    path: ./RuleSet/Telegram.yaml
    url: https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/master/Clash/Providers/Ruleset/Telegram.yaml
    interval: 86400
  Global:
    type: http
    behavior: classical
    path: ./RuleSet/Global.yaml
    url: https://raw.githubusercontent.com/PoseidonWake/hosts/master/Global.yaml
    interval: 86400
  ChinaDomain:
    type: http
    behavior: classical
    path: ./RuleSet/ChinaDomain.yaml
    url: https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/master/Clash/Providers/ChinaDomain.yaml
    interval: 86400
  Porn:
    type: http
    behavior: classical
    path: ./RuleSet/StreamingMedia/Porn.yaml
    url: https://raw.githubusercontent.com/PoseidonWake/hosts/master/media.yaml
    interval: 86400
  DMM:
    type: http
    behavior: domain
    path: ./RuleSet/StreamingMedia/DMM.yaml
    url: https://raw.githubusercontent.com/PoseidonWake/hosts/master/dmmjp.yaml
    interval: 86400
  CNFIX:
    type: http
    behavior: domain
    path: ./RuleSet/cnfix.yaml
    url: https://raw.githubusercontent.com/PoseidonWake/hosts/master/cnfix.yaml
    interval: 86400
  ChinaCompanyIp:
    type: http
    behavior: ipcidr
    path: ./RuleSet/ChinaCompanyIp.yaml
    url: https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/master/Clash/Providers/ChinaCompanyIp.yaml
    interval: 86400
  adblock:
    type: http
    behavior: domain
    format: yaml
    path: ./RuleSet/AWAvenue-Ads-Rule-Clash.yaml
    url: https://gcore.jsdelivr.net/gh/TG-Twilight/AWAvenue-Ads-Rule@main/Filters/AWAvenue-Ads-Rule-Clash.yaml
    interval: 86400
rules:
  - RULE-SET,Local,DIRECT
  - GEOSITE,private,DIRECT
  ## direct FCM
  - AND,((NETWORK,TCP),(DST-PORT,5228-5230)),DIRECT
  - RULE-SET,CNFIX,ğŸ‡¨ğŸ‡³ CN
#  - DOMAIN-SUFFIX,zephiuo.top,DIRECT
  - DOMAIN,injections.adguard.org,ğŸš€ Global
  - RULE-SET,Unbreak,ğŸ‡¨ğŸ‡³ CN
  - RULE-SET,adblock,ğŸš« AD
  - GEOSITE,category-ads-all,ğŸš« AD
  - RULE-SET,AppleCDN,ğŸ‘â€ğŸ—¨ Maybe
  - RULE-SET,MicrosoftCDN,ğŸ‘â€ğŸ—¨ Maybe
  - RULE-SET,AppleCN,ğŸ‘â€ğŸ—¨ Maybe
  - RULE-SET,AppleCDN,ğŸ‘â€ğŸ—¨ Maybe
  - RULE-SET,Apple,ğŸ Apple&MS
  - RULE-SET,Microsoft,ğŸ Apple&MS
  - RULE-SET,Telegram,ğŸ“² Telegram
  - RULE-SET,Porn,ğŸ¥ Streaming
  - RULE-SET,DMM,ğŸ‡¯ğŸ‡µ JP
  - RULE-SET,GoogleDrive,ğŸ¥ Streaming
  - RULE-SET,Streaming,ğŸ¥ Streaming
  - RULE-SET,Download,ğŸ¥ Streaming
  - RULE-SET,Global,ğŸš€ Global
  - RULE-SET,StreamingSE,ğŸ‘â€ğŸ—¨ Maybe
  - RULE-SET,China,ğŸ‡¨ğŸ‡³ CN
  - RULE-SET,ChinaDomain,ğŸ‡¨ğŸ‡³ CN
  - GEOSITE,geolocation-!cn,ğŸš€ Global
  - GEOSITE,cn,ğŸ‡¨ğŸ‡³ CN
  - RULE-SET,ChinaCompanyIp,ğŸ‡¨ğŸ‡³ CN
  - GEOIP,CN,ğŸ‡¨ğŸ‡³ CN
  - MATCH,Final
